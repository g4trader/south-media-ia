<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Dashboard Video Institucional 90s - Copacol</title>
<link rel="preconnect" href="https://cdn.jsdelivr.net"/>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  :root{--bg:#0F1023;--bg2:#16213E;--panel:#1A1A2E;--muted:#9CA3AF;--stroke: rgba(139,92,246,.28);
         --grad: linear-gradient(135deg,#8B5CF6,#EC4899);}
  *{box-sizing:border-box;margin:0;padding:0}
  body{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;color:#fff;
       background:linear-gradient(135deg,var(--bg) 0%,var(--bg2) 50%,var(--panel) 100%)}
  .container{max-width:1320px;margin:0 auto;padding:32px 32px 40px}
  .card{background:rgba(26,26,46,.8);border:1px solid var(--stroke);border-radius:14px;padding:20px;margin-bottom:24px;backdrop-filter:blur(8px)}
  .header{display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;gap:20px}
  .logo{display:flex;align-items:center;gap:12px}
  .logo-icon{width:40px;height:40px;border-radius:10px;background:var(--grad);display:grid;place-items:center;font-weight:700}
  .muted{color:var(--muted)}
  .tabs{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin:20px 0}
  .tab{border:1px solid rgba(148,163,184,.2);background:rgba(255,255,255,.04);padding:10px;border-radius:10px;text-align:center;cursor:pointer;color:var(--muted);font-weight:600}
  .tab.active{background:var(--grad);color:#fff;box-shadow:0 8px 24px rgba(139,92,246,.35)}
  .hidden{display:none}
  .metrics{display:grid;grid-template-columns:repeat(4,1fr);gap:16px}
  @media(max-width:900px){.metrics{grid-template-columns:repeat(2,1fr)} .tabs{grid-template-columns:repeat(2,1fr)} }
  .metric{border:1px solid rgba(148,163,184,.18);border-radius:12px;padding:14px;display:flex;flex-direction:column;gap:6px}
  .metric .label{text-transform:uppercase;letter-spacing:.06em;color:var(--muted);font-size:.82rem}
  .metric .value{font-size:1.7rem;font-weight:800;line-height:1.15}
  .kpis{display:grid;grid-template-columns:1fr 1fr;gap:20px}
  @media(max-width:900px){.kpis{grid-template-columns:1fr}}
  table{width:100%;border-collapse:collapse;min-width:800px}
  thead th{color:var(--muted);text-transform:uppercase;letter-spacing:.06em;font-size:.8rem;text-align:left;border-bottom:1px solid rgba(148,163,184,.22);padding:1rem;white-space:nowrap}
  tbody td{padding:1rem;border-bottom:1px solid rgba(148,163,184,.14);white-space:nowrap}
  tbody tr:nth-child(even) td{background:rgba(255,255,255,0.02)}
  tbody tr:hover td{background:rgba(255,255,255,0.05)}
  .badge{display:inline-flex;align-items:center;gap:8px;padding:6px 12px;border-radius:999px;background:rgba(0,255,136,.2);border:1px solid rgba(0,255,136,.4);font-weight:600;color:#00ff88}
  .strategy-card{background:rgba(255,255,255,0.05);padding:16px;border-radius:12px;border-left:4px solid #8B5CF6;margin-bottom:12px}
  .strategy-card h4{color:#8B5CF6;margin-bottom:8px}
  .strategy-card ul{margin:0;padding-left:18px;line-height:1.6;color:rgba(148,163,184,0.9)}
  .targeting-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:12px}
  .targeting-card{background:rgba(255,255,255,0.05);padding:12px;border-radius:8px;border-left:4px solid #EC4899}
  .targeting-card strong{color:#EC4899}
  .targeting-card div{font-size:0.8rem;color:rgba(255,255,255,0.7);margin-top:4px}
</style>
</head>
<body>
<div class="container">
  <div class="card header">
    <div class="logo">
      <div class="logo-icon">SM</div>
      <div>
        <div style="font-weight:800;font-size:1.1rem">South Media</div>
        <div class="muted">Dashboard Video Institucional 90s</div>
      </div>
    </div>
    <div>
      <div style="font-weight:700;font-size:1rem;text-align:right">Copacol - YouTube</div>
      <div class="muted" style="text-align:right">Status: <span class="badge">EM ANDAMENTO</span></div>
    </div>
  </div>

  <div class="tabs">
    <div class="tab active" data-tab="overview">üé¨ Vis√£o Geral</div>
    <div class="tab" data-tab="performance">üìä Performance</div>
    <div class="tab" data-tab="strategy">üéØ Estrat√©gia</div>
    <div class="tab" data-tab="insights">üí° Insights</div>
  </div>

  <!-- OVERVIEW -->
  <div id="tab-overview">
    <div class="metrics" id="metrics-overview-top"></div>
    <div class="kpis">
      <div class="card"><canvas id="chartBudget"></canvas></div>
      <div class="card"><canvas id="chartPerformance"></canvas></div>
    </div>
    <div class="card" style="margin-top:16px">
      <h3 style="margin-bottom:10px">Resumo da Campanha</h3>
      <div class="muted" style="margin-bottom:10px">Video Institucional 90s - YouTube - Per√≠odo: 08/09/2025 a 05/10/2025</div>
      <div style="overflow:auto">
        <table id="tableCampaign">
          <thead>
            <tr>
              <th>M√©trica</th><th>Contratado</th><th>Realizado</th><th>% Execu√ß√£o</th>
            </tr>
          </thead>
          <tbody id="tbodyCampaign"></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- PERFORMANCE -->
  <div id="tab-performance" class="hidden">
    <div class="metrics" id="metrics-performance"></div>
    
    <div class="card" style="margin-top:16px">
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px">
        <h3 style="margin:0">Performance Di√°ria</h3>
        <div style="display:flex; gap:10px; align-items:center">
          <span style="color:var(--muted); font-size:0.9rem">
            √öltima atualiza√ß√£o: <span id="lastUpdatePerformance">‚Äî</span>
          </span>
          <button onclick="refreshPerformanceData()" style="background:var(--grad); color:white; border:none; padding:8px 16px; border-radius:8px; cursor:pointer; font-size:0.9rem">
            üîÑ Atualizar
          </button>
        </div>
      </div>
      <div style="overflow:auto; max-height:500px; border:1px solid rgba(148,163,184,0.2); border-radius:8px">
        <table id="performanceTable">
          <thead>
            <tr>
              <th>Data</th><th>Criativo</th><th>Investimento (R$)</th>
              <th>Impress√µes</th><th>Starts</th><th>Skips</th><th>Complete Views</th><th>CPM (R$)</th>
            </tr>
          </thead>
          <tbody id="performanceBody"></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- STRATEGY -->
  <div id="tab-strategy" class="hidden">
    <div class="card">
      <h3 style="margin-bottom:16px">üéØ Estrat√©gia de Segmenta√ß√£o</h3>
      
      <div class="strategy-card">
        <h4>Segmenta√ß√£o por Conte√∫do</h4>
        <ul>
          <li><strong>Canais:</strong> Canais de culin√°ria, programas sobre agroneg√≥cio, canais de not√≠cias que abordam temas de economia e sustentabilidade, canais de bem-estar e sa√∫de que promovam alimenta√ß√£o balanceada</li>
          <li><strong>T√≥picos:</strong> Segmentar por t√≥picos como 'Alimentos e Bebidas', 'Agricultura', 'Sustentabilidade', 'Sa√∫de e Bem-Estar', 'Not√≠cias'</li>
          <li><strong>Palavras-chave:</strong> 'alimentos saud√°veis', 'cooperativismo', 'produ√ß√£o sustent√°vel', 'qualidade alimentar', 'frango Copacol', 'peixe Copacol', 'receitas f√°ceis', 'vida no campo', 'agroneg√≥cio Brasil'</li>
        </ul>
      </div>

      <div class="strategy-card">
        <h4>P√∫blicos-alvo com Afinidade</h4>
        <div class="targeting-grid">
          <div class="targeting-card">
            <strong>Alimentos e Bebidas</strong>
            <div>Pessoas interessadas em culin√°ria, receitas, alimenta√ß√£o saud√°vel, produtos org√¢nicos</div>
          </div>
          <div class="targeting-card">
            <strong>Casa e Jardim</strong>
            <div>Pessoas interessadas em bem-estar familiar, organiza√ß√£o do lar, qualidade dos alimentos</div>
          </div>
          <div class="targeting-card">
            <strong>Not√≠cias e Pol√≠tica</strong>
            <div>Pessoas que se mant√™m informadas sobre agroneg√≥cio, economia e quest√µes sociais</div>
          </div>
          <div class="targeting-card">
            <strong>Estilo de Vida e Hobbies</strong>
            <div>Pessoas com interesses em vida no campo, sustentabilidade, agricultura familiar</div>
          </div>
        </div>
      </div>

      <div class="strategy-card">
        <h4>Palavras e Canais Negativados</h4>
        <ul>
          <li><strong>Veganos</strong> - Exclus√£o de audi√™ncia vegana</li>
          <li><strong>Vegetarianos</strong> - Exclus√£o de audi√™ncia vegetariana</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- INSIGHTS -->
  <div id="tab-insights" class="hidden">
    <div class="card" id="insightsCards">
      <h3 style="margin-bottom:8px">Resumo de Insights</h3>
      <ul style="margin:0; padding-left:18px; line-height:1.6; color:rgba(148,163,184,0.9)">
        <li><strong>üé¨ Video Institucional 90s:</strong> Campanha focada em v√≠deo institucional de 90 segundos no YouTube com objetivo de maximizar alcance qualificado</li>
        <li><strong>üí∞ Or√ßamento:</strong> R$ 49.009,90 contratados para 12.250.000 impress√µes no per√≠odo de 08/09 a 05/10/2025</li>
        <li><strong>üìä Estrat√©gia:</strong> Foco em segmenta√ß√£o por conte√∫do e afinidade para atingir audi√™ncia qualificada</li>
        <li><strong>üéØ Targeting:</strong> Segmenta√ß√£o por canais de culin√°ria, agroneg√≥cio, not√≠cias e bem-estar</li>
        <li><strong>üì± Distribui√ß√£o:</strong> YouTube como canal principal com CPM de R$ 4,00</li>
      </ul>
    </div>

    <div class="card" style="margin-top:16px">
      <h3 style="margin-bottom:10px">Otimiza√ß√µes Recomendadas</h3>
      <ul style="margin:0; padding-left:18px; line-height:1.6; color:rgba(148,163,184,0.9)">
        <li><strong>üé¨ Criativos:</strong> Testar diferentes vers√µes do v√≠deo de 90s para otimizar reten√ß√£o</li>
        <li><strong>üìä Segmenta√ß√£o:</strong> Refinar targeting baseado na performance dos t√≥picos</li>
        <li><strong>üí∞ Or√ßamento:</strong> Ajustar distribui√ß√£o baseado no CPM e performance</li>
        <li><strong>‚è∞ Timing:</strong> Otimizar hor√°rios de veicula√ß√£o baseado no engajamento</li>
        <li><strong>üéØ Palavras-chave:</strong> Expandir lista de palavras-chave baseada na performance</li>
      </ul>
    </div>

    <div class="card" style="margin-top:16px">
      <h3 style="margin-bottom:10px">Pr√≥ximas A√ß√µes</h3>
      <ul style="margin:0; padding-left:18px; line-height:1.6; color:rgba(148,163,184,0.9)">
        <li>Monitorar performance di√°ria para ajustes r√°pidos de or√ßamento</li>
        <li>Analisar dados de completude de v√≠deo para otimizar reten√ß√£o</li>
        <li>Expandir segmenta√ß√£o baseada na performance dos t√≥picos</li>
        <li>Testar novos formatos criativos para melhorar engajamento</li>
        <li>Revisar exclus√µes de palavras-chave baseada na performance</li>
      </ul>
    </div>
  </div>

</div>
</div>

<!-- Carregar dados reais da planilha -->
<script src="dashboard_data_copacol_video.js"></script>
<script>

// Helpers
const fmtBR = (v, dec=2) => isNaN(v)||v===null||v==="" ? "‚Äî" :
  new Intl.NumberFormat('pt-BR',{minimumFractionDigits:dec, maximumFractionDigits:dec}).format(Number(v));
const fmtInt = v => isNaN(v)||v===null||v==="" ? "‚Äî" :
  new Intl.NumberFormat('pt-BR',{maximumFractionDigits:0}).format(Number(v));
const pct = v => (isNaN(v)||v===null||v==="") ? "‚Äî" : `${(Number(v)*100).toFixed(1)}%`;

// Tabs
document.querySelectorAll('.tab').forEach(t=>t.addEventListener('click',()=>{
  document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));
  t.classList.add('active');
  const id = t.dataset.tab;
  ['overview','performance','strategy','insights'].forEach(key=>{
    document.getElementById('tab-'+key).classList.toggle('hidden', key!==id);
  });
}));

// OVERVIEW
const topMetrics = [
  ["üí∞ Or√ßamento Contratado", `R$ ${fmtBR(CONS["Budget Contratado (R$)"])}`],
  ["üí∏ Or√ßamento Utilizado", `R$ ${fmtBR(CONS["Budget Utilizado (R$)"])}`],
  ["üé¨ Impress√µes", fmtInt(CONS["Impress√µes"])],
  ["üìà Complete Views", fmtInt(CONS["Complete Views"])],
];
document.getElementById('metrics-overview-top').innerHTML = topMetrics.map(
  m=>`<div class='metric'><div class='label'>${m[0]}</div><div class='value'>${m[1]}</div></div>`).join('');

// Overview table
const tbody = document.getElementById('tbodyCampaign');
const campaignRows = [
  ["Or√ßamento (R$)", `R$ ${fmtBR(CONS["Budget Contratado (R$)"])}`, `R$ ${fmtBR(CONS["Budget Utilizado (R$)"])}`, pct(CONS["Pacing (%)"])],
  ["Impress√µes", fmtInt(CAMPAIGN_DATA.contracted_impressions), fmtInt(CONS["Impress√µes"]), pct((CONS["Impress√µes"] / CAMPAIGN_DATA.contracted_impressions) * 100)],
  ["Starts", "‚Äî", fmtInt(CONS["Starts"]), "‚Äî"],
  ["Skips", "‚Äî", fmtInt(CONS["Skips"]), "‚Äî"],
  ["Complete Views", "‚Äî", fmtInt(CONS["Complete Views"]), "‚Äî"],
  ["CPM (R$)", `R$ ${fmtBR(CAMPAIGN_DATA.cpm)}`, `R$ ${fmtBR(CONS["CPM (R$)"])}`, "‚Äî"]
];

campaignRows.forEach(row => {
  tbody.insertAdjacentHTML('beforeend', `
    <tr>
      <td>${row[0]}</td>
      <td>${row[1]}</td>
      <td>${row[2]}</td>
      <td>${row[3]}</td>
    </tr>`);
});

// Overview charts
const ctx1 = document.getElementById('chartBudget');
const ctx2 = document.getElementById('chartPerformance');

// Budget chart
new Chart(ctx1, {
  type:'doughnut',
  data:{
    labels: ['Utilizado', 'Restante'],
    datasets:[{
      data:[CONS["Budget Utilizado (R$)"], CONS["Budget Contratado (R$)"] - CONS["Budget Utilizado (R$)"]],
      backgroundColor: ['#8B5CF6', '#374151']
    }]
  },
  options:{
    plugins:{
      legend:{position:'bottom'},
      title:{display:true, text:'Distribui√ß√£o do Or√ßamento', color:'#fff'}
    }
  }
});

// Performance chart
new Chart(ctx2, {
  type:'bar',
  data:{
    labels: ['Impress√µes', 'Starts', 'Complete Views'],
    datasets:[{
      label:'Volume',
      data:[CONS["Impress√µes"]/1000, CONS["Starts"]/1000, CONS["Complete Views"]/1000],
      backgroundColor: ['#EC4899', '#8B5CF6', '#10B981']
    }]
  },
  options:{
    responsive:true,
    plugins:{
      legend:{position:'bottom'},
      title:{display:true, text:'Performance da Campanha', color:'#fff'}
    },
    scales:{
      y:{beginAtZero:true}
    }
  }
});

// PERFORMANCE
const performanceMetrics = [
  ["üìä Or√ßamento Utilizado", `R$ ${fmtBR(CONS["Budget Utilizado (R$)"])}`],
  ["üéØ Pacing", pct(CONS["Pacing (%)"])],
  ["üé¨ Complete Views", fmtInt(CONS["Complete Views"])],
  ["üìà Starts", fmtInt(CONS["Starts"])],
  ["üí∞ CPM", `R$ ${fmtBR(CONS["CPM (R$)"])}`],
  ["üñ®Ô∏è Impress√µes", fmtInt(CONS["Impress√µes"])],
  ["‚è≠Ô∏è Skips", fmtInt(CONS["Skips"])],
  ["üìä Taxa de Reten√ß√£o", pct((CONS["Complete Views"] / CONS["Starts"]) * 100)]
];

document.getElementById('metrics-performance').innerHTML = performanceMetrics.map(
  m=>`<div class='metric'><div class='label'>${m[0]}</div><div class='value'>${m[1]}</div></div>`).join('');

// Performance table
const performanceBody = document.getElementById('performanceBody');
// Limpar conte√∫do anterior
performanceBody.innerHTML = '';

DAILY.forEach(r=>{
  // Determinar se a linha tem dados (para destacar)
  const hasData = r.impressions > 0 || r.starts > 0 || r.spend > 0;
  const rowClass = hasData ? 'style="background: rgba(16,185,129,0.1); border-left: 3px solid #10B981;"' : '';
  
  performanceBody.insertAdjacentHTML('beforeend', `
    <tr ${rowClass}>
      <td>${r.date||'‚Äî'}</td>
      <td>${r.creative||'‚Äî'}</td>
      <td>R$ ${fmtBR(r.spend)}</td>
      <td>${fmtInt(r.impressions)}</td>
      <td>${fmtInt(r.starts)}</td>
      <td>${fmtInt(r.skips)}</td>
      <td>${fmtInt(r.complete)}</td>
      <td>R$ ${fmtBR(r.cpm)}</td>
    </tr>`);
});

// Adicionar totalizadores na parte inferior da tabela
performanceBody.insertAdjacentHTML('beforeend', `
  <tr style="background: rgba(139,92,246,0.1); border-top: 2px solid #8B5CF6; font-weight: 700;">
    <td><strong>TOTAL</strong></td>
    <td>‚Äî</td>
    <td><strong>R$ ${fmtBR(CONS["Budget Utilizado (R$)"])}</strong></td>
    <td><strong>${fmtInt(CONS["Impress√µes"])}</strong></td>
    <td><strong>${fmtInt(CONS["Starts"])}</strong></td>
    <td><strong>${fmtInt(CONS["Skips"])}</strong></td>
    <td><strong>${fmtInt(CONS["Complete Views"])}</strong></td>
    <td><strong>R$ ${fmtBR(CONS["CPM (R$)"])}</strong></td>
  </tr>`);

// Fun√ß√£o para atualizar dados de performance
function refreshPerformanceData() {
  console.log('Atualizando dados de performance...');
  
  // Atualizar timestamp
  document.getElementById('lastUpdatePerformance').textContent = new Date().toLocaleString('pt-BR');
  
  // Recarregar a tabela de performance
  loadPerformanceTable();
  
  // Mostrar notifica√ß√£o
  showNotification('Dados de performance atualizados!', 'success');
}

// Fun√ß√£o para carregar tabela de performance
function loadPerformanceTable() {
  const performanceBody = document.getElementById('performanceBody');
  performanceBody.innerHTML = '';

  DAILY.forEach(r=>{
    const hasData = r.impressions > 0 || r.starts > 0 || r.spend > 0;
    const rowClass = hasData ? 'style="background: rgba(16,185,129,0.1); border-left: 3px solid #10B981;"' : '';
    
    performanceBody.insertAdjacentHTML('beforeend', `
      <tr ${rowClass}>
        <td>${r.date||'‚Äî'}</td>
        <td>${r.creative||'‚Äî'}</td>
        <td>R$ ${fmtBR(r.spend)}</td>
        <td>${fmtInt(r.impressions)}</td>
        <td>${fmtInt(r.starts)}</td>
        <td>${fmtInt(r.skips)}</td>
        <td>${fmtInt(r.complete)}</td>
        <td>R$ ${fmtBR(r.cpm)}</td>
      </tr>`);
  });

  // Adicionar totalizadores
  performanceBody.insertAdjacentHTML('beforeend', `
    <tr style="background: rgba(139,92,246,0.1); border-top: 2px solid #8B5CF6; font-weight: 700;">
      <td><strong>TOTAL</strong></td>
      <td>‚Äî</td>
      <td><strong>R$ ${fmtBR(CONS["Budget Utilizado (R$)"])}</strong></td>
      <td><strong>${fmtInt(CONS["Impress√µes"])}</strong></td>
      <td><strong>${fmtInt(CONS["Starts"])}</strong></td>
      <td><strong>${fmtInt(CONS["Skips"])}</strong></td>
      <td><strong>${fmtInt(CONS["Complete Views"])}</strong></td>
      <td><strong>R$ ${fmtBR(CONS["CPM (R$)"])}</strong></td>
    </tr>`);
}

// Fun√ß√£o para mostrar notifica√ß√µes
function showNotification(message, type = 'info') {
  const notification = document.createElement('div');
  notification.style.cssText = `
    position: fixed;
    top: 20px;
    right: 20px;
    background: ${type === 'error' ? '#EF4444' : type === 'success' ? '#10B981' : '#3B82F6'};
    color: white;
    padding: 12px 20px;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    z-index: 1000;
    font-size: 14px;
    max-width: 400px;
    word-wrap: break-word;
  `;
  notification.textContent = message;
  
  document.body.appendChild(notification);
  
  setTimeout(() => {
    if (notification.parentNode) {
      notification.parentNode.removeChild(notification);
    }
  }, 3000);
}

// Atualizar timestamp inicial
document.getElementById('lastUpdatePerformance').textContent = new Date().toLocaleString('pt-BR');

</script>
</body>
</html>
