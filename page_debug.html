<html lang="pt-BR"><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Painel de Controle - Dashboards</title>
<link rel="preconnect" href="https://cdn.jsdelivr.net">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  :root{
    --bg:#0f0f23;
    --bg2:#1a1a2e;
    --panel:#16213e;
    --stroke:rgba(148,163,184,.25);
    --muted:rgba(148,163,184,.8);
    --grad:linear-gradient(135deg,#ff6b35,#8b5cf6);
    --accent:#00ff88;
    --danger:#ff4757;
    --warning:#ffa726;
  }
  *{box-sizing:border-box;margin:0;padding:0}
  body{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;color:#fff;
       background:linear-gradient(135deg,var(--bg) 0%,var(--bg2) 50%,var(--panel) 100%);
       min-height:100vh;}
  .container{max-width:1400px;margin:0 auto;padding:32px 32px 40px}
  .header{display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;gap:20px;margin-bottom:40px}
  .logo{display:flex;align-items:center;gap:12px}
  .logo-icon{width:48px;height:48px;border-radius:12px;background:var(--grad);display:grid;place-items:center;font-weight:700;font-size:1.2rem}
  .header-content h1{font-size:2.5rem;font-weight:800;background:var(--grad);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
  .header-content p{color:var(--muted);font-size:1.1rem;margin-top:8px}
  .stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;margin-bottom:40px}
  .stat-card{background:rgba(26,26,46,.8);border:1px solid var(--stroke);border-radius:16px;padding:24px;backdrop-filter:blur(8px);text-align:center}
  .stat-number{font-size:2.5rem;font-weight:800;background:var(--grad);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
  .stat-label{color:var(--muted);font-size:.9rem;text-transform:uppercase;letter-spacing:.1em;margin-top:8px}
  .dashboards-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:24px}
  .dashboard-card{background:rgba(26,26,46,.8);border:1px solid var(--stroke);border-radius:16px;overflow:hidden;transition:all .3s ease;backdrop-filter:blur(8px)}
  .dashboard-card:hover{transform:translateY(-4px);border-color:rgba(255,107,53,.5);box-shadow:0 12px 32px rgba(139,92,246,.2)}
  .card-thumbnail{height:200px;background:linear-gradient(135deg,rgba(255,107,53,.1),rgba(139,92,246,.1));display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden}
  .card-thumbnail::before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>') repeat;opacity:0.3}
  .thumbnail-content{display:flex;flex-direction:column;align-items:center;gap:12px;z-index:1}
  .thumbnail-icon{font-size:3rem;opacity:0.8}
  .thumbnail-charts{display:flex;gap:8px;align-items:end}
  .chart-bar{width:8px;background:var(--grad);border-radius:2px;opacity:0.7}
  .chart-bar:nth-child(1){height:20px}
  .chart-bar:nth-child(2){height:35px}
  .chart-bar:nth-child(3){height:25px}
  .chart-bar:nth-child(4){height:40px}
  .chart-bar:nth-child(5){height:30px}
  .card-content{padding:24px}
  .card-title{font-size:1.25rem;font-weight:700;margin-bottom:8px;color:#fff}
  .card-description{color:var(--muted);font-size:.9rem;line-height:1.5;margin-bottom:20px}
  .card-meta{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;font-size:.85rem}
  .card-status{display:inline-flex;align-items:center;gap:6px;padding:4px 12px;border-radius:20px;font-weight:600;font-size:.8rem}
  .status-active{background:rgba(0,255,136,.2);border:1px solid rgba(0,255,136,.4);color:var(--accent)}
  .card-actions{display:flex;gap:12px;width:100%}
  .card-link{display:inline-flex;align-items:center;gap:8px;padding:12px 24px;background:var(--grad);color:#fff;text-decoration:none;border-radius:10px;font-weight:600;transition:all .3s ease;flex:1;justify-content:center}
  .card-link:hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(139,92,246,.4)}
  .sync-button{display:inline-flex;align-items:center;gap:8px;padding:12px 16px;background:linear-gradient(135deg,rgba(0,255,136,.2),rgba(0,255,136,.4));border:1px solid rgba(0,255,136,.5);color:var(--accent);text-decoration:none;border-radius:10px;font-weight:600;transition:all .3s ease;cursor:pointer;min-width:120px;justify-content:center}
  .sync-button:hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(0,255,136,.3);background:linear-gradient(135deg,rgba(0,255,136,.3),rgba(0,255,136,.5))}
  .sync-button:disabled{opacity:0.6;cursor:not-allowed;transform:none}
  .sync-button.syncing{animation:pulse 1.5s infinite}
  @keyframes pulse{0%,100%{opacity:1}50%{opacity:0.7}}
  .loading{display:flex;align-items:center;justify-content:center;padding:40px;color:var(--muted)}
  .spinner{border:2px solid rgba(148,163,184,.2);border-top:2px solid var(--accent);border-radius:50%;width:24px;height:24px;animation:spin 1s linear infinite;margin-right:12px}
  @keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
  .empty-state{text-align:center;padding:60px 20px;color:var(--muted)}
  .empty-state h3{font-size:1.5rem;margin-bottom:12px;color:#fff}
  .empty-state p{font-size:1rem;line-height:1.6}
  @media (max-width:768px){
    .container{padding:20px 16px}
    .header-content h1{font-size:2rem}
    .dashboards-grid{grid-template-columns:1fr}
    .stats{grid-template-columns:repeat(2,1fr)}
  }
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <div class="logo">
      <div class="logo-icon">📊</div>
    </div>
    <div class="header-content">
      <h1>Painel de Controle</h1>
      <p>Central de gerenciamento de dashboards analíticos</p>
    </div>
  </div>

  <div class="stats">
    <div class="stat-card">
      <div class="stat-number" id="totalDashboards">7</div>
      <div class="stat-label">Dashboards</div>
    </div>
    <div class="stat-card">
      <div class="stat-number" id="activeDashboards">7</div>
      <div class="stat-label">Ativos</div>
    </div>
    <div class="stat-card">
      <div class="stat-number" id="lastUpdate">Agora</div>
      <div class="stat-label">Última Atualização</div>
    </div>
  </div>

  <div id="loadingState" class="loading" style="display: none;">
    <div class="spinner"></div>
    Carregando dashboards...
  </div>

  <div id="dashboardsContainer" class="dashboards-grid" style="display: grid;">
    <div class="dashboard-card">
      <div class="card-thumbnail">
        <div class="thumbnail-content">
          <div class="thumbnail-icon">🎯</div>
          <div class="thumbnail-charts">
            <div class="chart-bar"></div>
            <div class="chart-bar"></div>
            <div class="chart-bar"></div>
            <div class="chart-bar"></div>
            <div class="chart-bar"></div>
          </div>
        </div>
      </div>
      <div class="card-content">
        <h3 class="card-title">Dashboard Sonho</h3>
        <p class="card-description">Dashboard multicanal com análise de vídeo + display e footfall das lojas Recibom</p>
        <div class="card-meta">
          <span class="card-status status-active">🟢 Ativo</span>
          <span style="color: var(--muted);">Multicanal</span>
        </div>
        
    <div class="card-actions">
      <a href="/static/dash_sonho.html" class="card-link" target="_blank">
        <span>📊</span>
        <span>Acessar</span>
      </a>
      <button class="sync-button" onclick="syncDashboard('dash_sonho.html')" id="sync-dash_sonho.html">
        <span>🔄</span>
        <span>Sync</span>
      </button>
    </div>
  
      </div>
    </div>
  
    <div class="dashboard-card">
      <div class="card-thumbnail">
        <div class="thumbnail-content">
          <div class="thumbnail-icon">🛒</div>
          <div class="thumbnail-charts">
            <div class="chart-bar"></div>
            <div class="chart-bar"></div>
            <div class="chart-bar"></div>
            <div class="chart-bar"></div>
            <div class="chart-bar"></div>
          </div>
        </div>
      </div>
      <div class="card-content">
        <h3 class="card-title">Dashboard Copacol</h3>
        <p class="card-description">Dashboard de performance para campanhas Copacol</p>
        <div class="card-meta">
          <span class="card-status status-active">🟢 Ativo</span>
          <span style="color: var(--muted);">Retail</span>
        </div>
        
    <a href="/static/dash_copacol.html" class="card-link" target="_blank">
      <span>📊</span>
      <span>Acessar Dashboard</span>
    </a>
  
      </div>
    </div>
  
    <div class="dashboard-card">
      <div class="card-thumbnail">
        <div class="thumbnail-content">
          <div class="thumbnail-icon">🔥</div>
          <div class="thumbnail-charts">
            <div class="chart-bar"></div>
            <div class="chart-bar"></div>
            <div class="chart-bar"></div>
            <div class="chart-bar"></div>
            <div class="chart-bar"></div>
          </div>
        </div>
      </div>
      <div class="card-content">
        <h3 class="card-title">Copacol - Mestre das Grelhas</h3>
        <p class="card-description">Dashboard especializado para campanha Mestre das Grelhas</p>
        <div class="card-meta">
          <span class="card-status status-active">🟢 Ativo</span>
          <span style="color: var(--muted);">Retail</span>
        </div>
        
    <a href="/static/dash_copacol_mestre_das_grelhas.html" class="card-link" target="_blank">
      <span>📊</span>
      <span>Acessar Dashboard</span>
    </a>
  
      </div>
    </div>
  
    <div class="dashboard-card">
      <div class="card-thumbnail">
        <div class="thumbnail-content">
          <div class="thumbnail-icon">💊</div>
          <div class="thumbnail-charts">
            <div class="chart-bar"></div>
            <div class="chart-bar"></div>
            <div class="chart-bar"></div>
            <div class="chart-bar"></div>
            <div class="chart-bar"></div>
          </div>
        </div>
      </div>
      <div class="card-content">
        <h3 class="card-title">Dashboard Dauher Hidrabene</h3>
        <p class="card-description">Análise de performance para campanhas Dauher Hidrabene</p>
        <div class="card-meta">
          <span class="card-status status-active">🟢 Ativo</span>
          <span style="color: var(--muted);">Saúde</span>
        </div>
        
    <a href="/static/dash_dauher_hidrabene.html" class="card-link" target="_blank">
      <span>📊</span>
      <span>Acessar Dashboard</span>
    </a>
  
      </div>
    </div>
  
    <div class="dashboard-card">
      <div class="card-thumbnail">
        <div class="thumbnail-content">
          <div class="thumbnail-icon">🎓</div>
          <div class="thumbnail-charts">
            <div class="chart-bar"></div>
            <div class="chart-bar"></div>
            <div class="chart-bar"></div>
            <div class="chart-bar"></div>
            <div class="chart-bar"></div>
          </div>
        </div>
      </div>
      <div class="card-content">
        <h3 class="card-title">Dashboard Sebrae</h3>
        <p class="card-description">Dashboard de métricas e KPIs para campanhas Sebrae</p>
        <div class="card-meta">
          <span class="card-status status-active">🟢 Ativo</span>
          <span style="color: var(--muted);">Educacional</span>
        </div>
        
    <a href="/static/dash_sebrae.html" class="card-link" target="_blank">
      <span>📊</span>
      <span>Acessar Dashboard</span>
    </a>
  
      </div>
    </div>
  
    <div class="dashboard-card">
      <div class="card-thumbnail">
        <div class="thumbnail-content">
          <div class="thumbnail-icon">🏫</div>
          <div class="thumbnail-charts">
            <div class="chart-bar"></div>
            <div class="chart-bar"></div>
            <div class="chart-bar"></div>
            <div class="chart-bar"></div>
            <div class="chart-bar"></div>
          </div>
        </div>
      </div>
      <div class="card-content">
        <h3 class="card-title">Dashboard Unicesusc</h3>
        <p class="card-description">Análise de performance para campanhas Unicesusc</p>
        <div class="card-meta">
          <span class="card-status status-active">🟢 Ativo</span>
          <span style="color: var(--muted);">Educacional</span>
        </div>
        
    <a href="/static/dash_unicesusc.html" class="card-link" target="_blank">
      <span>📊</span>
      <span>Acessar Dashboard</span>
    </a>
  
      </div>
    </div>
  
    <div class="dashboard-card">
      <div class="card-thumbnail">
        <div class="thumbnail-content">
          <div class="thumbnail-icon">🏥</div>
          <div class="thumbnail-charts">
            <div class="chart-bar"></div>
            <div class="chart-bar"></div>
            <div class="chart-bar"></div>
            <div class="chart-bar"></div>
            <div class="chart-bar"></div>
          </div>
        </div>
      </div>
      <div class="card-content">
        <h3 class="card-title">Dashboard Unimed</h3>
        <p class="card-description">Dashboard de métricas para campanhas Unimed</p>
        <div class="card-meta">
          <span class="card-status status-active">🟢 Ativo</span>
          <span style="color: var(--muted);">Saúde</span>
        </div>
        
    <a href="/static/dash_unimed.html" class="card-link" target="_blank">
      <span>📊</span>
      <span>Acessar Dashboard</span>
    </a>
  
      </div>
    </div>
  </div>

  <div id="emptyState" class="empty-state" style="display:none">
    <h3>Nenhum dashboard encontrado</h3>
    <p>Verifique se os arquivos estão na pasta /static</p>
  </div>
</div>

<script>
// Lista de dashboards disponíveis
const dashboards = [
  {
    file: 'dash_sonho.html',
    name: 'Dashboard Sonho',
    description: 'Dashboard multicanal com análise de vídeo + display e footfall das lojas Recibom',
    status: 'active',
    category: 'Multicanal',
    lastUpdate: 'Hoje',
    icon: '🎯'
  },
  {
    file: 'dash_copacol.html',
    name: 'Dashboard Copacol',
    description: 'Dashboard de performance para campanhas Copacol',
    status: 'active',
    category: 'Retail',
    lastUpdate: 'Ontem',
    icon: '🛒'
  },
  {
    file: 'dash_copacol_mestre_das_grelhas.html',
    name: 'Copacol - Mestre das Grelhas',
    description: 'Dashboard especializado para campanha Mestre das Grelhas',
    status: 'active',
    category: 'Retail',
    lastUpdate: 'Ontem',
    icon: '🔥'
  },
  {
    file: 'dash_dauher_hidrabene.html',
    name: 'Dashboard Dauher Hidrabene',
    description: 'Análise de performance para campanhas Dauher Hidrabene',
    status: 'active',
    category: 'Saúde',
    lastUpdate: '2 dias',
    icon: '💊'
  },
  {
    file: 'dash_sebrae.html',
    name: 'Dashboard Sebrae',
    description: 'Dashboard de métricas e KPIs para campanhas Sebrae',
    status: 'active',
    category: 'Educacional',
    lastUpdate: '3 dias',
    icon: '🎓'
  },
  {
    file: 'dash_unicesusc.html',
    name: 'Dashboard Unicesusc',
    description: 'Análise de performance para campanhas Unicesusc',
    status: 'active',
    category: 'Educacional',
    lastUpdate: '1 semana',
    icon: '🏫'
  },
  {
    file: 'dash_unimed.html',
    name: 'Dashboard Unimed',
    description: 'Dashboard de métricas para campanhas Unimed',
    status: 'active',
    category: 'Saúde',
    lastUpdate: '1 semana',
    icon: '🏥'
  }
];

// Função para criar card de dashboard
function createDashboardCard(dashboard) {
  const statusClass = dashboard.status === 'active' ? 'status-active' : '';
  const statusText = dashboard.status === 'active' ? '🟢 Ativo' : '🔴 Inativo';
  
  // Verificar se é o Dashboard Sonho para adicionar botão de sync
  const isSonhoDashboard = dashboard.file === 'dash_sonho.html';
  
  const actionsHtml = isSonhoDashboard ? `
    <div class="card-actions">
      <a href="/static/${dashboard.file}" class="card-link" target="_blank">
        <span>📊</span>
        <span>Acessar</span>
      </a>
      <button class="sync-button" onclick="syncDashboard('${dashboard.file}')" id="sync-${dashboard.file}">
        <span>🔄</span>
        <span>Sync</span>
      </button>
    </div>
  ` : `
    <a href="/static/${dashboard.file}" class="card-link" target="_blank">
      <span>📊</span>
      <span>Acessar Dashboard</span>
    </a>
  `;
  
  return `
    <div class="dashboard-card">
      <div class="card-thumbnail">
        <div class="thumbnail-content">
          <div class="thumbnail-icon">${dashboard.icon}</div>
          <div class="thumbnail-charts">
            <div class="chart-bar"></div>
            <div class="chart-bar"></div>
            <div class="chart-bar"></div>
            <div class="chart-bar"></div>
            <div class="chart-bar"></div>
          </div>
        </div>
      </div>
      <div class="card-content">
        <h3 class="card-title">${dashboard.name}</h3>
        <p class="card-description">${dashboard.description}</p>
        <div class="card-meta">
          <span class="card-status ${statusClass}">${statusText}</span>
          <span style="color: var(--muted);">${dashboard.category}</span>
        </div>
        ${actionsHtml}
      </div>
    </div>
  `;
}

// Função para carregar dashboards
function loadDashboards() {
  const container = document.getElementById('dashboardsContainer');
  const loadingState = document.getElementById('loadingState');
  const emptyState = document.getElementById('emptyState');
  
  // Simular carregamento
  setTimeout(() => {
    loadingState.style.display = 'none';
    
    if (dashboards.length === 0) {
      emptyState.style.display = 'block';
    } else {
      container.style.display = 'grid';
      container.innerHTML = dashboards.map(createDashboardCard).join('');
      
      // Atualizar estatísticas
      document.getElementById('totalDashboards').textContent = dashboards.length;
      document.getElementById('activeDashboards').textContent = 
        dashboards.filter(d => d.status === 'active').length;
      document.getElementById('lastUpdate').textContent = 'Agora';
    }
  }, 1000);
}

// Inicializar quando a página carregar
document.addEventListener('DOMContentLoaded', loadDashboards);

// Função para verificar se dashboard existe (opcional)
async function checkDashboardExists(file) {
  try {
    const response = await fetch(`/static/${file}`, { method: 'HEAD' });
    return response.ok;
  } catch {
    return false;
  }
}

// Função para sincronizar dashboard via Cloud Run
async function syncDashboard(file) {
  const buttonId = `sync-${file}`;
  const button = document.getElementById(buttonId);
  
  if (!button) {
    console.error('Botão de sync não encontrado');
    return;
  }
  
  // Desabilitar botão e mostrar estado de loading
  button.disabled = true;
  button.classList.add('syncing');
  button.innerHTML = '<span>⏳</span><span>Sincronizando...</span>';
  
  try {
    console.log(`🔄 Iniciando sincronização do ${file}...`);
    
    // Fazer chamada para o Cloud Run dashboard-automation
    const response = await fetch('https://dashboard-builder-6f3ckz7c7q-uc.a.run.app/trigger', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        // Nota: Em produção, você precisaria de autenticação adequada
        // 'Authorization': 'Bearer YOUR_TOKEN'
      },
      body: JSON.stringify({
        test_mode: false
      })
    });
    
    if (!response.ok) {
      throw new Error(`HTTP ${response.status}: ${response.statusText}`);
    }
    
    const result = await response.json();
    console.log('✅ Sincronização concluída:', result);
    
    // Sucesso
    button.innerHTML = '<span>✅</span><span>Concluído!</span>';
    button.style.background = 'linear-gradient(135deg,rgba(0,255,136,.3),rgba(0,255,136,.5))';
    
    // Atualizar timestamp
    updateLastSyncTime();
    
    // Resetar botão após 3 segundos
    setTimeout(() => {
      button.disabled = false;
      button.classList.remove('syncing');
      button.innerHTML = '<span>🔄</span><span>Sync</span>';
      button.style.background = '';
    }, 3000);
    
  } catch (error) {
    console.error('❌ Erro na sincronização:', error);
    
    // Erro
    button.innerHTML = '<span>❌</span><span>Erro</span>';
    button.style.background = 'linear-gradient(135deg,rgba(255,71,87,.3),rgba(255,71,87,.5))';
    
    // Resetar botão após 3 segundos
    setTimeout(() => {
      button.disabled = false;
      button.classList.remove('syncing');
      button.innerHTML = '<span>🔄</span><span>Sync</span>';
      button.style.background = '';
    }, 3000);
  }
}

// Função para atualizar timestamp da última sincronização
function updateLastSyncTime() {
  const lastUpdateElement = document.getElementById('lastUpdate');
  if (lastUpdateElement) {
    const now = new Date();
    const timeString = now.toLocaleTimeString('pt-BR', { 
      hour: '2-digit', 
      minute: '2-digit' 
    });
    lastUpdateElement.textContent = timeString;
  }
}
</script>


</body></html>